{
  "name": "Lifecycle Logging Strategy",
  "version": "1.0.0",
  "description": "Example strategy demonstrating lifecycle events with logging. This strategy is designed to test the start/shutdown lifecycle functionality. It logs when the strategy is started (with timestamp), when shutdown is requested (with uptime statistics), cleanup progress during shutdown, and when shutdown is complete.",
  "author": "Midcurve Finance",
  "abi": [
    {
      "type": "constructor",
      "inputs": [
        {
          "name": "operator_",
          "type": "address",
          "internalType": "address"
        },
        {
          "name": "core_",
          "type": "address",
          "internalType": "address"
        }
      ],
      "stateMutability": "nonpayable"
    },
    {
      "type": "function",
      "name": "core",
      "inputs": [],
      "outputs": [
        {
          "name": "",
          "type": "address",
          "internalType": "address"
        }
      ],
      "stateMutability": "view"
    },
    {
      "type": "function",
      "name": "epoch",
      "inputs": [],
      "outputs": [
        {
          "name": "",
          "type": "uint64",
          "internalType": "uint64"
        }
      ],
      "stateMutability": "view"
    },
    {
      "type": "function",
      "name": "eventsProcessed",
      "inputs": [],
      "outputs": [
        {
          "name": "",
          "type": "uint256",
          "internalType": "uint256"
        }
      ],
      "stateMutability": "view"
    },
    {
      "type": "function",
      "name": "gcEpoch",
      "inputs": [
        {
          "name": "epochToSweep",
          "type": "uint64",
          "internalType": "uint64"
        },
        {
          "name": "maxItems",
          "type": "uint256",
          "internalType": "uint256"
        }
      ],
      "outputs": [
        {
          "name": "swept",
          "type": "uint256",
          "internalType": "uint256"
        },
        {
          "name": "done",
          "type": "bool",
          "internalType": "bool"
        }
      ],
      "stateMutability": "nonpayable"
    },
    {
      "type": "function",
      "name": "lifecycleStatus",
      "inputs": [],
      "outputs": [
        {
          "name": "",
          "type": "uint8",
          "internalType": "enum LifecycleMixin.LifecycleStatus"
        }
      ],
      "stateMutability": "view"
    },
    {
      "type": "function",
      "name": "operator",
      "inputs": [],
      "outputs": [
        {
          "name": "",
          "type": "address",
          "internalType": "address"
        }
      ],
      "stateMutability": "view"
    },
    {
      "type": "function",
      "name": "startedAt",
      "inputs": [],
      "outputs": [
        {
          "name": "",
          "type": "uint256",
          "internalType": "uint256"
        }
      ],
      "stateMutability": "view"
    },
    {
      "type": "function",
      "name": "step",
      "inputs": [
        {
          "name": "input",
          "type": "bytes",
          "internalType": "bytes"
        }
      ],
      "outputs": [],
      "stateMutability": "nonpayable"
    },
    {
      "type": "function",
      "name": "submitEffectResult",
      "inputs": [
        {
          "name": "epoch_",
          "type": "uint64",
          "internalType": "uint64"
        },
        {
          "name": "idempotencyKey",
          "type": "bytes32",
          "internalType": "bytes32"
        },
        {
          "name": "ok",
          "type": "bool",
          "internalType": "bool"
        },
        {
          "name": "data",
          "type": "bytes",
          "internalType": "bytes"
        }
      ],
      "outputs": [],
      "stateMutability": "nonpayable"
    },
    {
      "type": "error",
      "name": "AlreadyActive",
      "inputs": []
    },
    {
      "type": "error",
      "name": "AlreadyShutdown",
      "inputs": []
    },
    {
      "type": "error",
      "name": "AlreadyShuttingDown",
      "inputs": []
    },
    {
      "type": "error",
      "name": "AlreadyStarting",
      "inputs": []
    },
    {
      "type": "error",
      "name": "EffectNeeded",
      "inputs": [
        {
          "name": "epoch",
          "type": "uint64",
          "internalType": "uint64"
        },
        {
          "name": "idempotencyKey",
          "type": "bytes32",
          "internalType": "bytes32"
        },
        {
          "name": "effectType",
          "type": "bytes32",
          "internalType": "bytes32"
        },
        {
          "name": "payload",
          "type": "bytes",
          "internalType": "bytes"
        }
      ]
    },
    {
      "type": "error",
      "name": "InvalidStepEvent",
      "inputs": []
    },
    {
      "type": "error",
      "name": "NotActive",
      "inputs": []
    },
    {
      "type": "error",
      "name": "NotCore",
      "inputs": []
    },
    {
      "type": "error",
      "name": "NotOperator",
      "inputs": []
    },
    {
      "type": "error",
      "name": "UnknownLifecycleCommand",
      "inputs": [
        {
          "name": "command",
          "type": "bytes32",
          "internalType": "bytes32"
        }
      ]
    },
    {
      "type": "error",
      "name": "UnsupportedLifecycleVersion",
      "inputs": [
        {
          "name": "got",
          "type": "uint32",
          "internalType": "uint32"
        }
      ]
    },
    {
      "type": "error",
      "name": "ZeroAddress",
      "inputs": []
    }
  ],
  "bytecode": "0x60806040523480156200001157600080fd5b506040516200156e3803806200156e8339810160408190526200003491620000c5565b81816001600160a01b03821615806200005457506001600160a01b038116155b15620000735760405163d92e233d60e01b815260040160405180910390fd5b600080546001600160a01b039384166001600160a01b0319918216179091556001805492909316911617905550620000fd9050565b80516001600160a01b0381168114620000c057600080fd5b919050565b60008060408385031215620000d957600080fd5b620000e483620000a8565b9150620000f460208401620000a8565b90509250929050565b611461806200010d6000396000f3fe608060405234801561001057600080fd5b50600436106100935760003560e01c8063b89f756d11610066578063b89f756d1461012c578063c41b486f14610143578063cdeba62d14610158578063f21f537d1461016b578063f2f4eb261461017457600080fd5b8063570ca7351461009857806358571086146100c85780637f79cdb5146100e9578063900cf0cf14610111575b600080fd5b6000546100ab906001600160a01b031681565b6040516001600160a01b0390911681526020015b60405180910390f35b6005546100dc90600160401b900460ff1681565b6040516100bf9190610f07565b6100fc6100f7366004610f4b565b610187565b604080519283529015156020830152016100bf565b6005546040516001600160401b0390911681526020016100bf565b61013560075481565b6040519081526020016100bf565b610156610151366004610fb6565b6103b4565b005b61015661016636600461102b565b610570565b61013560065481565b6001546100ab906001600160a01b031681565b60015460009081906001600160a01b031633146101b75760405163e2aae06b60e01b815260040160405180910390fd5b6005546001600160401b03908116908516106102095760405162461bcd60e51b815260206004820152600c60248201526b0c2c6e8d2ecca40cae0dec6d60a31b60448201526064015b60405180910390fd5b600083116102465760405162461bcd60e51b815260206004820152600a60248201526906d61784974656d733d360b41b6044820152606401610200565b6001600160401b038416600090815260036020908152604080832060049092529091205481548082106102835760006001945094505050506103ad565b600061028f8784611082565b90508181111561029c5750805b80831015610319576001600160401b038816600090815260026020526040812085549091908690869081106102d3576102d361109b565b600091825260208083209091015483528201929092526040018120805460ff19168155906103046001830182610e81565b50508280610311906110b1565b93505061029c565b6001600160401b03881660009081526004602052604090205461033c90826110ca565b6001600160401b038916600090815260046020526040902082905595508181036103a3576001600160401b038816600090815260036020526040812061038191610ebe565b6001600160401b038816600090815260046020526040812055600194506103a8565b600094505b505050505b9250929050565b6000546001600160a01b031633146103df57604051631f0853c160e21b815260040160405180910390fd5b6005546001600160401b03908116908616111561042e5760405162461bcd60e51b815260206004820152600d60248201526c65706f636820746f6f206e657760981b6044820152606401610200565b6001600160401b0385166000908152600260209081526040808320878452909152812090815460ff16600281111561046857610468610ef1565b146104fc5783801561048f57506001815460ff16600281111561048d5761048d610ef1565b145b806104b85750831580156104b857506002815460ff1660028111156104b6576104b6610ef1565b145b6104f65760405162461bcd60e51b815260206004820152600f60248201526e0e6e8c2e8eae640dad2e6dac2e8c6d608b1b6044820152606401610200565b50610569565b8361050857600261050b565b60015b8154829060ff1916600183600281111561052757610527610ef1565b02179055506001810161053b838583611173565b50506001600160401b0385166000908152600360209081526040822080546001810182559083529120018490555b5050505050565b6000546001600160a01b0316331461059b57604051631f0853c160e21b815260040160405180910390fd5b60008060006105aa85856105e5565b9250925092506105bb838383610625565b5050600580546001600160401b038082166001011667ffffffffffffffff19909116179055505050565b60008060608084101561060b5760405163dffef72760e01b815260040160405180910390fd5b61061784860186611232565b919790965090945092505050565b7fd5b3bbdfb49ea04b2c75b919c721f1ef65f0754b86e4cbf7df9b4bcd53ceaf2a830361065c576106578383836106d4565b505050565b6106678383836106d4565b61066f6107a3565b61067857505050565b6106ba7f1655553bc1b9c3d7c22d4d2c91d7e3aecd8631d5e7ef50a80da092529a41302c604051806060016040528060218152602001611440602191396107cb565b600780549060006106ca836110b1565b9190505550505050565b7fd5b3bbdfb49ea04b2c75b919c721f1ef65f0754b86e4cbf7df9b4bcd53ceaf2a83036107515763ffffffff821660011461072a57604051635f65f6e560e11b815263ffffffff83166004820152602401610200565b6000818060200190518101906107409190611307565b905061074b816107db565b50505050565b6003600554600160401b900460ff16600481111561077157610771610ef1565b03610657576000610780610a3c565b9050801561074b576005805460ff60401b1916600160421b17905561074b610a9c565b60006002600554600160401b900460ff1660048111156107c5576107c5610ef1565b14905090565b6107d760008383610ae0565b5050565b7fbe3c26a64d88239991ba164ff2b468dd1f37dd3d8107c4c763966a7a0402c73f8103610930576001600554600160401b900460ff16600481111561082257610822610ef1565b036108405760405163e8adcfdd60e01b815260040160405180910390fd5b6002600554600160401b900460ff16600481111561086057610860610ef1565b0361087e57604051637cdf305160e11b815260040160405180910390fd5b6003600554600160401b900460ff16600481111561089e5761089e610ef1565b036108bc5760405163645a81c160e11b815260040160405180910390fd5b6004600554600160401b900460ff1660048111156108dc576108dc610ef1565b036108fa576040516365eca15b60e11b815260040160405180910390fd5b6005805460ff60401b1916600160401b179055610915610c31565b506005805460ff60401b191668020000000000000000179055565b7f2b22d873f791abe31d4310d327f02daef6f297a9bbbce4a994bf2bbeadf02d578103610a20576004600554600160401b900460ff16600481111561097757610977610ef1565b03610995576040516365eca15b60e11b815260040160405180910390fd5b6003600554600160401b900460ff1660048111156109b5576109b5610ef1565b036109d35760405163645a81c160e11b815260040160405180910390fd5b6005805460ff60401b1916680300000000000000001790556109f3610cf3565b60006109fd610a3c565b905080156107d7576005805460ff60401b1916600160421b1790556107d7610a9c565b6040516314fcdc7f60e31b815260048101829052602401610200565b6000610a967ffab63ea2599b36a75d094c6a3bf77f542c4c487c76c0654e6de33d3affc7898360405180604001604052806016815260200175436c65616e7570207374657020657865637574696e6760501b8152506107cb565b50600190565b610ade7fe7ce6dc7d427ccb222a5bd9b6ea61718cfb743900db9f6fb2e26959c6864965a6040518060600160405280602c81526020016113e4602c9139610d31565b565b6000610af46005546001600160401b031690565b600554604051626c6f6760e81b60208201526001600160c01b031960c093841b81166023830152600160481b90920490921b16602b8201526033016040516020818303038152906040528051906020012090506000848484604051602001610b5c9190611366565b60408051601f1981840301815290829052610b7b939291602001611380565b60405160208183030381529060405290506000610bb9837f3039cf35251df02018e097e77a4115938266b3ac806536a8f6032d2875a046cf84610d3d565b5090506000816001811115610bd057610bd0610ef1565b1480610bed57506001816001811115610beb57610beb610ef1565b145b15610c2957600580546001600160401b03600160481b80830482166001019091160270ffffffffffffffff000000000000000000199091161790555b505050505050565b4260065560408051808201909152601d81527f53747261746567792073746172746564207375636365737366756c6c790000006020820152610c94907f7013b17339381ec56e018f5beebef3a1c866af6ad7187d55197200301b43fc2f90610d31565b610ade7fe7ce6dc7d427ccb222a5bd9b6ea61718cfb743900db9f6fb2e26959c6864965a6040518060400160405280601c81526020017f5472616e736974696f6e656420746f2041435449564520737461746500000000815250610d31565b610ade7fe7ce6dc7d427ccb222a5bd9b6ea61718cfb743900db9f6fb2e26959c6864965a604051806060016040528060308152602001611410603091395b6107d760018383610ae0565b6005546001600160401b0316600090815260026020908152604080832086845290915281206060906001815460ff166002811115610d7d57610d7d610ef1565b03610e1e57600081600101808054610d94906110f3565b80601f0160208091040260200160405190810160405280929190818152602001828054610dc0906110f3565b8015610e0d5780601f10610de257610100808354040283529160200191610e0d565b820191906000526020600020905b815481529060010190602001808311610df057829003601f168201915b505050505090509250925050610e79565b6002815460ff166002811115610e3657610e36610ef1565b03610e4d57600181600101808054610d94906110f3565b6005546040516373ecc7fd60e11b8152610200916001600160401b0316908890889088906004016113ab565b935093915050565b508054610e8d906110f3565b6000825580601f10610e9d575050565b601f016020900490600052602060002090810190610ebb9190610ed8565b50565b5080546000825590600052602060002090810190610ebb91905b5b80821115610eed5760008155600101610ed9565b5090565b634e487b7160e01b600052602160045260246000fd5b6020810160058310610f2957634e487b7160e01b600052602160045260246000fd5b91905290565b80356001600160401b0381168114610f4657600080fd5b919050565b60008060408385031215610f5e57600080fd5b610f6783610f2f565b946020939093013593505050565b60008083601f840112610f8757600080fd5b5081356001600160401b03811115610f9e57600080fd5b6020830191508360208285010111156103ad57600080fd5b600080600080600060808688031215610fce57600080fd5b610fd786610f2f565b94506020860135935060408601358015158114610ff357600080fd5b925060608601356001600160401b0381111561100e57600080fd5b61101a88828901610f75565b969995985093965092949392505050565b6000806020838503121561103e57600080fd5b82356001600160401b0381111561105457600080fd5b61106085828601610f75565b90969095509350505050565b634e487b7160e01b600052601160045260246000fd5b808201808211156110955761109561106c565b92915050565b634e487b7160e01b600052603260045260246000fd5b6000600182016110c3576110c361106c565b5060010190565b818103818111156110955761109561106c565b634e487b7160e01b600052604160045260246000fd5b600181811c9082168061110757607f821691505b60208210810361112757634e487b7160e01b600052602260045260246000fd5b50919050565b601f82111561065757600081815260208120601f850160051c810160208610156111545750805b601f850160051c820191505b81811015610c2957828155600101611160565b6001600160401b0383111561118a5761118a6110dd565b61119e8361119883546110f3565b8361112d565b6000601f8411600181146111d257600085156111ba5750838201355b600019600387901b1c1916600186901b178355610569565b600083815260209020601f19861690835b8281101561120357868501358255602094850194600190920191016111e3565b50868210156112205760001960f88860031b161c19848701351681555b505060018560011b0183555050505050565b60008060006060848603121561124757600080fd5b83359250602084013563ffffffff8116811461126257600080fd5b915060408401356001600160401b038082111561127e57600080fd5b818601915086601f83011261129257600080fd5b8135818111156112a4576112a46110dd565b604051601f8201601f19908116603f011681019083821181831017156112cc576112cc6110dd565b816040528281528960208487010111156112e557600080fd5b8260208601602083013760006020848301015280955050505050509250925092565b60006020828403121561131957600080fd5b5051919050565b6000815180845260005b818110156113465760208185018101518683018201520161132a565b506000602082860101526020601f19601f83011685010191505092915050565b6020815260006113796020830184611320565b9392505050565b60ff841681528260208201526060604082015260006113a26060830184611320565b95945050505050565b6001600160401b03851681528360208201528260408201526080606082015260006113d96080830184611320565b969550505050505056fe53687574646f776e20636f6d706c657465202d207374726174656779206973206e6f7720696e61637469766553687574646f776e20726571756573746564202d20626567696e6e696e6720677261636566756c2073687574646f776e53746570206576656e7420726563656976656420616e642070726f636573736564",
  "constructorParams": [
    {
      "name": "operator_",
      "type": "address",
      "source": "operator-address",
      "ui": {
        "element": "hidden",
        "label": "Operator Address",
        "description": "Per-strategy automation wallet (KMS-backed) that executes step() calls"
      }
    },
    {
      "name": "core_",
      "type": "address",
      "source": "core-address",
      "ui": {
        "element": "hidden",
        "label": "Core Address",
        "description": "Core orchestrator address that funds GC operations"
      }
    }
  ],
  "tags": [
    "example",
    "lifecycle",
    "logging",
    "testing"
  ],
  "quoteToken": {
    "type": "basic-currency",
    "symbol": "USD"
  },
  "logTopics": {
    "CUSTOM_EVENT_RECEIVED": "Step event received and processed"
  }
}